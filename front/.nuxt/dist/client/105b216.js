(window.webpackJsonp=window.webpackJsonp||[]).push([[17,16],{440:function(e,t,l){var content=l(452);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(29).default)("662a6ece",content,!1,{sourceMap:!1})},451:function(e,t,l){"use strict";l(440)},452:function(e,t,l){var o=l(28)(!1);o.push([e.i,".email-code{width:33%;height:38px;float:right}.email-code img{cursor:pointer;vertical-align:middle;height:38px}",""]),e.exports=o},453:function(e,t,l){var content=l(467);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,l(29).default)("50524426",content,!1,{sourceMap:!1})},463:function(e,t,l){"use strict";l.r(t);l(97);var o=l(191),r={props:{user:{type:Object}},data:function(){return{emailRules:{email:[{required:!0,message:"邮箱地址不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]},{required:!0,validator:function(e,t,l){Object(o.b)(t).then((function(e){!0===e.data?l():l(new Error("邮箱已经存在"))}))},trigger:"blur"}],password:[{required:!0,message:"密码不能为",trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}]},emailForm:{password:"",email:"",code:"",uuid:""},codeUrl:"",loading:!1,isShow:!1,count:0}},created:function(){this.getCode()},watch:{user:function(e,t){this.emailForm.email=this.handleCampusUrl(e.avatar)}},methods:{getCode:function(){var e=this;Object(o.f)().then((function(t){e.captchaEnabled=void 0===t.captchaEnabled||t.captchaEnabled,e.captchaEnabled&&(e.codeUrl="data:image/gif;base64,"+t.img,e.emailForm.uuid=t.uuid)}))},handleEmail:function(){var e=this;this.$refs.emailForm.validate((function(t){t&&(e.loading=!0,Object(o.a)(e.emailForm).then((function(t){e.$message({message:t.msg,type:"success"}),e.loading=!1,e.getCode(),e.verification()})).catch((function(){e.loading=!1,e.getCode()})))}))},verification:function(){var e=this;this.isShow=!0,this.count=60;var t=setInterval((function(){e.count--,e.count<=0&&(e.isShow=!1,clearInterval(t))}),1e3)}}},n=(l(451),l(18)),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-form",{ref:"emailForm",attrs:{model:e.emailForm,rules:e.emailRules}},[l("h3",[e._v("密码验证")]),e._v(" "),l("el-form-item",{attrs:{prop:"password"}},[l("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.emailForm.password,callback:function(t){e.$set(e.emailForm,"password",t)},expression:"emailForm.password"}},[l("svg-icon",{staticClass:"el-input__icon input-icon",attrs:{slot:"prefix","icon-class":"password"},slot:"prefix"})],1)],1),e._v(" "),l("el-form-item",{attrs:{prop:"email"}},[l("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"邮箱"},model:{value:e.emailForm.email,callback:function(t){e.$set(e.emailForm,"email",t)},expression:"emailForm.email"}},[l("svg-icon",{staticClass:"el-input__icon input-icon",attrs:{slot:"prefix","icon-class":"user"},slot:"prefix"})],1)],1),e._v(" "),l("el-form-item",{attrs:{prop:"code"}},[l("el-input",{staticStyle:{width:"63%"},attrs:{"auto-complete":"off",placeholder:"验证码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleEmail.apply(null,arguments)}},model:{value:e.emailForm.code,callback:function(t){e.$set(e.emailForm,"code",t)},expression:"emailForm.code"}},[l("svg-icon",{staticClass:"el-input__icon input-icon",attrs:{slot:"prefix","icon-class":"validCode"},slot:"prefix"})],1),e._v(" "),l("div",{staticClass:"email-code"},[l("img",{staticClass:"email-code-img",attrs:{src:e.codeUrl},on:{click:e.getCode}})])],1),e._v(" "),l("el-form-item",{staticStyle:{width:"100%"}},[l("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,size:"medium",type:e.isShow?"info":"primary",disabled:e.isShow},nativeOn:{click:function(t){return t.preventDefault(),e.handleEmail.apply(null,arguments)}}},[e.loading?l("span",[e._v("请 求 中...")]):l("span",[e._v(e._s(e.isShow?e.count:"开始绑定"))])])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SvgIcon:l(189).default})},466:function(e,t,l){"use strict";l(453)},467:function(e,t,l){var o=l(28)(!1);o.push([e.i,".email-code{width:33%;height:38px;float:right}.email-code img{cursor:pointer;vertical-align:middle;height:38px}",""]),e.exports=o},499:function(e,t,l){"use strict";l.r(t);var o=l(190),r=l(191),n={components:{userEmail:l(463).default},props:{user:{type:Object}},data:function(){return{rules:{nickName:[{required:!0,message:"用户昵称不能为空",trigger:"blur"}]},emailRules:{email:[{required:!0,message:"邮箱地址不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]},{required:!0,validator:function(e,t,l){Object(r.b)(t).then((function(e){!0===e.data?l():l(new Error("邮箱已经存在"))}))},trigger:"blur"}]},dialogVisible:!1,emailForm:{email:"",code:"",uuid:""},codeUrl:"",loading:!1}},created:function(){},methods:{submit:function(){var e=this;this.$refs.form.validate((function(t){t&&o.a.updateUserProfile(e.user).then((function(t){e.$modal.msgSuccess("修改成功")}))}))},close:function(){this.$tab.closePage()},openDialog:function(){this.dialogVisible=!0},getCode:function(){var e=this;Object(r.f)().then((function(t){e.captchaEnabled=void 0===t.captchaEnabled||t.captchaEnabled,e.captchaEnabled&&(e.codeUrl="data:image/gif;base64,"+t.img,e.emailForm.uuid=t.uuid)}))},handleEmail:function(){}}},c=(l(466),l(18)),component=Object(c.a)(n,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("el-form",{ref:"form",attrs:{model:e.user,rules:e.rules,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"用户昵称",prop:"nickName"}},[l("el-input",{attrs:{maxlength:"30"},model:{value:e.user.nickName,callback:function(t){e.$set(e.user,"nickName",t)},expression:"user.nickName"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[l("div",{staticStyle:{display:"flex"}},[l("el-input",{attrs:{maxlength:"50"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1)]),e._v(" "),l("el-form-item",{attrs:{label:"性别"}},[l("el-radio-group",{model:{value:e.user.sex,callback:function(t){e.$set(e.user,"sex",t)},expression:"user.sex"}},[l("el-radio",{attrs:{label:"0"}},[e._v("男")]),e._v(" "),l("el-radio",{attrs:{label:"1"}},[e._v("女")])],1)],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("保存")]),e._v(" "),l("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.close}},[e._v("关闭")])],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"更换邮箱",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[void 0!==e.user?l("userEmail",{attrs:{user:e.user}}):e._e()],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);